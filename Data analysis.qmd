---
title: "Data analysis"
format:
  html:
    echo: false
    message: false

---
## Introduction

In today's fast-paced academic environment, mental health issues such as depression have become increasingly prevalent among students. This project focuses on analyzing a large dataset of students to uncover patterns and factors associated with depression levels. The dataset contains information on demographics, academic pressure, work pressure, sleep habits, dietary practices, financial stress, satisfaction with study and work, and family history of mental illness.

The primary goal of this analysis is to understand how various personal, academic, and lifestyle factors contribute to depression among students. By exploring relationships between variables such as sleep duration, CGPA, financial stress, and suicidal thoughts, we aim to identify key areas that may require attention for mental health support and intervention programs.

Through a combination of descriptive statistics, visual exploration, and correlation analysis, this study provides insights that can help educators, counselors, and policymakers develop better strategies to support student mental health and well-being.
```{r}
#| message: false
library(tidyverse)
library(readr)
```

```{r}
depstud <- read_csv(
  file = "data/student_depression.csv",
  col_types = cols(.default = col_character())
)
```

```{r}
library(dplyr)
library(tibble)
library(ggplot2)

valid_cities <- c(
  "Visakhapatnam", "Bangalore", "Srinagar", "Varanasi", "Jaipur", "Pune",
  "Thane", "Chennai", "Nagpur", "Nashik", "Vadodara", "Kalyan", "Rajkot",
  "Ahmedabad", "Kolkata", "Mumbai", "Lucknow", "Indore", "Surat", "Ludhiana",
  "Bhopal", "Meerut", "Agra", "Ghaziabad", "Hyderabad", "Vasai-Virar", 
  "Kanpur", "Patna", "Faridabad", "Delhi", "Mira"
)

city_country_map <- tibble(
  City = valid_cities,
  Country = "India"
)

depstud_cleaned <- depstud %>%
  filter(City %in% valid_cities) %>%
  left_join(city_country_map, by = "City")

```

## Demographic Analysis

Understanding the demographic distribution of the students provides valuable context for interpreting the results of the study. The following aspects were analyzed:

- **Gender Distribution:** The proportion of male and female students was examined.
- **Age Distribution:** The age range and average age of the students were explored.
- **City Distribution:** The number of students from each major city was calculated.
- **Profession:** The dominant professions (e.g., Student, Working Professional) were identified.

These basic insights help characterize the sample and reveal any biases or patterns in the demographic background of the participants.

```{r}
# Gender Distribution
depstud_cleaned %>%
  count(Gender) %>%
  ggplot(aes(x = Gender, y = n, fill = Gender)) +
  geom_col() +
  labs(title = "Gender Distribution", x = "Gender", y = "Count") +
  theme_minimal()

# Age Distribution
depstud_cleaned %>%
  mutate(Age = as.numeric(Age)) %>%
  ggplot(aes(x = Age)) +
  geom_histogram(binwidth = 2, fill = "#69b3a2", color = "black") +
  labs(title = "Age Distribution of Students", x = "Age", y = "Frequency") +
  theme_minimal()

# City Distribution (Top 10 Cities)
depstud_cleaned %>%
  count(City, sort = TRUE) %>%
  slice_head(n = 10) %>%
  ggplot(aes(x = reorder(City, n), y = n, fill = City)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(title = "Top 10 Cities Represented", x = "City", y = "Number of Students") +
  theme_minimal()

```
## Academic and Work-Related Factors
This plot shows a positive relationship between academic pressure and depression levels. As academic pressure increases, there is a slight upward trend in depression symptoms among students.

```{r}
#| message: false
depstud_cleaned %>%
  mutate(`Academic Pressure` = as.numeric(`Academic Pressure`),
         Depression = as.numeric(Depression)) %>%
  ggplot(aes(x = `Academic Pressure`, y = Depression)) +
  geom_jitter(width = 0.2, height = 0.3, alpha = 0.5, color = "#1f77b4") +
  labs(
    title = "Academic Pressure vs Depression",
    x = "Academic Pressure (Scale 0-5)",
    y = "Depression Level"
  ) +
  theme_minimal()

```
The bar chart shows the distribution of depression cases across different CGPA groups. Students with higher CGPA scores (8–10) report the highest number of depression cases, suggesting a potential link between academic achievement and mental health challenges.
Lower CGPA groups (<6) exhibit fewer cases of depression, indicating that higher academic performance may correlate with increased psychological pressure.
```{r}
depstud_cleaned %>%
  mutate(
    CGPA = as.numeric(CGPA),
    CGPA_Group = case_when(
      CGPA < 6 ~ "Low (<6)",
      CGPA >= 6 & CGPA < 7 ~ "Mid-Low (6-7)",
      CGPA >= 7 & CGPA < 8 ~ "Mid-High (7-8)",
      CGPA >= 8 ~ "High (8-10)",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(!is.na(CGPA_Group), Depression == 1) %>%  # ONLY Depression == "Yes"
  group_by(CGPA_Group) %>%
  summarise(Depressed_Count = n(), .groups = "drop") %>%
  ggplot(aes(x = CGPA_Group, y = Depressed_Count, fill = CGPA_Group)) +
  geom_col(width = 0.6, show.legend = FALSE) +
  labs(
    title = "Number of Depressed Students Across CGPA Groups",
    x = "CGPA Group",
    y = "Number of Depressed Students"
  ) +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5)
  )

```
The bar chart shows the number of depressed students across different degree types.
Students in Class 12 report the highest number of depression cases, followed by degrees like B.Ed, B.Arch, and B.Com.
Higher education degrees such as PhD, MBA, and LLM show fewer depression cases, possibly due to smaller sample sizes or better coping mechanisms developed over time.
```{r}
# Make sure CGPA and Depression are properly numeric/character first
depstud_cleaned %>%
  filter(!is.na(Degree), !is.na(Depression)) %>%
  mutate(Depression = as.character(Depression)) %>%
  filter(Depression == 1) %>%  # Only depressed students
  group_by(Degree) %>%
  summarise(Depressed_Count = n(), .groups = "drop") %>%
  ggplot(aes(x = reorder(Degree, -Depressed_Count), y = Depressed_Count, fill = Degree)) +
  geom_col(width = 0.6, show.legend = FALSE) +
  labs(
    title = "Number of Depressed Students by Degree Type",
    x = "Degree Type",
    y = "Number of Depressed Students"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 30, hjust = 1)
  )

```

```{r}
depstud_cleaned %>%
  mutate(`Sleep Duration` = gsub("'", "", `Sleep Duration`),
         `Sleep Duration` = factor(`Sleep Duration`, 
                                   levels = c("Less than 5 hours", "5-6 hours", "7-8 hours", "More than 8 hours", "Others"))) %>%
  ggplot(aes(x = `Sleep Duration`, y = Depression, color = `Sleep Duration`)) +
  geom_point(position = position_jitter(width = 0.2), size = 0.1, alpha = 0.7) +  # jitter to avoid overplotting
  scale_color_brewer(palette = "Set2") +
  labs(
    title = "Depression Levels by Sleep Duration",
    x = "Sleep Duration",
    y = "Depression Level"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    axis.title = element_text(face = "bold"),
    legend.position = "none"
  )
```

This scatter plot illustrates the relationship between sleep duration and depression levels among students. Sleep duration is categorized into "Less than 5 hours," "5–6 hours," "7–8 hours," "More than 8 hours," and "Others." Each point represents an individual student's depression score, with jittering applied to better display the density of data points. The majority of depression scores fall between 0 and 1.5 across all sleep categories. Students sleeping less than 7 hours tend to show a broader spread of depression levels compared to those sleeping 7–8 hours or more. The "Others" category contains very few observations, suggesting it represents a small and potentially atypical group. Different colors distinguish the sleep categories, and a minimalistic design enhances clarity and focus on the patterns within the data.





